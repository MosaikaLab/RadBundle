$em = $this->getDoctrine()->getManager();
$repository = $em->getRepository('{{ entity.doctrineName }}');
$item = $repository->find(intval($id));
if(!$item){
	return new View("{{ entity.name }} not found", Response::HTTP_NOT_FOUND);
}
$form = $this->createForm('{{ entity.fullClass|replace({'Entity': 'Form'}) }}Type',$item);
$input = json_decode($request->getContent(), true);
$data = array();
foreach($form as $k => $field){
	$k = str_replace(' ', '', ucwords(str_replace('_', ' ', $k)));
	$k = strtolower(substr($k,0,1)) . substr($k,1);
	if(isset($input[$k])){
		$type = $field->getConfig()->getType()->getInnerType();
		if($type instanceof \Symfony\Component\Form\Extension\Core\Type\DateType){
			$data[$k] = "2017-02-02";
		}else{
			$data[$k] = $input[$k];
		}
	}else{
		$form->remove($k);
	}	
}
if($form->submit($data)->isValid()){
    $em->persist($item);
    $em->flush();
{% if format == 'json' %}
    return $item;
{% else %}
return "";
{% endif %}
}else{
    $errors = array();
    foreach($form->getErrors(true) as $err){
    		$errors[$err->getOrigin()->getName()] = $err->getMessage();
    }
    return new View($errors, Response::HTTP_NOT_ACCEPTABLE);
}